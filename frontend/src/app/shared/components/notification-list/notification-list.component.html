<div class="space-y-6">
  <!-- Filters Bar -->
  <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4">
    <div class="flex flex-wrap items-center justify-between gap-4">
      <!-- Left side: Filters -->
      <div class="flex flex-wrap items-center gap-4">
        <!-- Status Filter -->
        <div class="flex gap-2">
          <button 
            class="px-4 py-2 text-sm font-medium rounded-lg transition-colors duration-200"
            [class.bg-primary-600]="filterType() === 'all'"
            [class.text-white]="filterType() === 'all'"
            [class.bg-white]="filterType() !== 'all'"
            [class.text-gray-700]="filterType() !== 'all'"
            [class.border]="filterType() !== 'all'"
            [class.border-gray-300]="filterType() !== 'all'"
            [class.hover:bg-gray-50]="filterType() !== 'all'"
            (click)="onFilterTypeChange('all')">
            All
          </button>
          <button 
            class="px-4 py-2 text-sm font-medium rounded-lg transition-colors duration-200"
            [class.bg-primary-600]="filterType() === 'unread'"
            [class.text-white]="filterType() === 'unread'"
            [class.bg-white]="filterType() !== 'unread'"
            [class.text-gray-700]="filterType() !== 'unread'"
            [class.border]="filterType() !== 'unread'"
            [class.border-gray-300]="filterType() !== 'unread'"
            [class.hover:bg-gray-50]="filterType() !== 'unread'"
            (click)="onFilterTypeChange('unread')">
            Unread
          </button>
          <button 
            class="px-4 py-2 text-sm font-medium rounded-lg transition-colors duration-200"
            [class.bg-primary-600]="filterType() === 'read'"
            [class.text-white]="filterType() === 'read'"
            [class.bg-white]="filterType() !== 'read'"
            [class.text-gray-700]="filterType() !== 'read'"
            [class.border]="filterType() !== 'read'"
            [class.border-gray-300]="filterType() !== 'read'"
            [class.hover:bg-gray-50]="filterType() !== 'read'"
            (click)="onFilterTypeChange('read')">
            Read
          </button>
        </div>

        <!-- Type Filter -->
        <div>
          <select 
            class="border border-gray-300 rounded-lg px-3 py-2 text-sm text-gray-700 focus:ring-primary-500 focus:border-primary-500"
            [(ngModel)]="filterNotificationType"
            (ngModelChange)="onNotificationTypeChange($event)">
            <option [ngValue]="null">All Types</option>
            <option [ngValue]="NotificationTypeEnum.IN_APP">In-App</option>
            <option [ngValue]="NotificationTypeEnum.EMAIL">Email</option>
            <option [ngValue]="NotificationTypeEnum.SMS">SMS</option>
            <option [ngValue]="NotificationTypeEnum.PUSH">Push</option>
          </select>
        </div>

        <!-- Bulk Actions -->
        @if (hasSelection()) {
          <div class="flex items-center gap-3 px-4 py-2 bg-primary-50 rounded-lg border border-primary-200">
            <span class="text-sm font-medium text-primary-700">{{ selectedIds().size }} selected</span>
            <button 
              class="px-3 py-1.5 bg-primary-600 text-white text-sm font-medium rounded-md hover:bg-primary-700 transition-colors duration-200"
              (click)="markSelectedAsRead()">
              Mark Selected as Read
            </button>
          </div>
        }
      </div>

      <!-- Right side: Mark All Read Button -->
      @if (hasNotifications()) {
        <button 
          class="flex items-center gap-2 px-4 py-2 bg-primary-600 text-white text-sm font-medium rounded-lg hover:bg-primary-700 transition-colors duration-200 shadow-sm"
          (click)="markAllAsRead()">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
            <polyline points="22 4 12 14.01 9 11.01"></polyline>
          </svg>
          Mark All Read
        </button>
      }
    </div>
  </div>

  <!-- Loading State -->
  @if (loading()) {
    <div class="flex items-center justify-center py-12">
      <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"></div>
      <span class="ml-3 text-gray-600">Loading notifications...</span>
    </div>
  } @else if (hasNotifications()) {
    <!-- Notifications Container -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
      <!-- Select All Row -->
      <div class="px-6 py-4 bg-gray-50 border-b border-gray-200 flex items-center justify-between">
        <label class="flex items-center gap-2 cursor-pointer">
          <input 
            type="checkbox"
            [checked]="allSelected()"
            (change)="toggleSelectAll()"
            class="w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500">
          <span class="text-sm font-medium text-gray-700">Select All</span>
        </label>
        <span class="text-sm text-gray-500">{{ totalElements() }} total notifications</span>
      </div>

      <!-- Notifications List -->
      <div class="divide-y divide-gray-200">
        @for (notification of notifications(); track notification.id) {
          <div 
            class="px-6 py-4 hover:bg-gray-50 transition-colors duration-150"
            [class.bg-primary-50]="!notification.isRead"
            [style.border-left]="!notification.isRead ? '4px solid ' + getNotificationConfig(notification).color : 'none'">
            <div class="flex items-start gap-4">
              <!-- Checkbox -->
              <div class="pt-1">
                <input 
                  type="checkbox"
                  [checked]="selectedIds().has(notification.id)"
                  (change)="toggleSelection(notification.id)"
                  class="w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500">
              </div>

              <!-- Icon -->
              <div class="flex-shrink-0 w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center text-xl">
                {{ getNotificationConfig(notification).icon }}
              </div>

              <!-- Content -->
              <div class="flex-1 min-w-0">
                <div class="flex items-center gap-2 mb-1">
                  <h3 class="text-base font-semibold text-gray-900">{{ notification.title }}</h3>
                  @if (!notification.isRead) {
                    <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                      New
                    </span>
                  }
                </div>
                <p class="text-sm text-gray-600 mb-2">{{ notification.message }}</p>
                <div class="flex items-center gap-4 text-xs text-gray-500">
                  <span class="flex items-center gap-1">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <circle cx="12" cy="12" r="10"></circle>
                      <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    {{ getTimeAgo(notification.createdAt) }}
                  </span>
                  <span class="capitalize">Priority: {{ notification.priority }}</span>
                </div>
              </div>

              <!-- Actions -->
              <div class="flex-shrink-0 pt-1">
                @if (!notification.isRead) {
                  <button 
                    class="p-2 text-primary-600 border border-gray-300 rounded-md hover:bg-primary-600 hover:text-white hover:border-primary-600 transition-colors duration-200"
                    (click)="markAsRead(notification)"
                    title="Mark as read">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                  </button>
                }
              </div>
            </div>
          </div>
        }
      </div>

      <!-- Pagination -->
      @if (totalPages() > 1) {
        <div class="px-6 py-4 bg-gray-50 border-t border-gray-200 flex items-center justify-center gap-2">
          <button 
            class="flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
            [disabled]="currentPage() === 0"
            (click)="previousPage()">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
            Previous
          </button>

          <div class="flex gap-1">
            @for (page of getPageNumbers(); track page) {
              @if (page === -1) {
                <span class="px-2 py-2 text-gray-400">...</span>
              } @else {
                <button 
                  class="min-w-[36px] h-9 px-3 text-sm font-medium rounded-lg transition-colors duration-200"
                  [class.bg-primary-600]="page === currentPage()"
                  [class.text-white]="page === currentPage()"
                  [class.bg-white]="page !== currentPage()"
                  [class.text-gray-700]="page !== currentPage()"
                  [class.border]="page !== currentPage()"
                  [class.border-gray-300]="page !== currentPage()"
                  [class.hover:bg-gray-50]="page !== currentPage()"
                  (click)="goToPage(page)">
                  {{ page + 1 }}
                </button>
              }
            }
          </div>

          <button 
            class="flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
            [disabled]="currentPage() === totalPages() - 1"
            (click)="nextPage()">
            Next
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
          </button>
        </div>
      }
    </div>
  } @else {
    <!-- Empty State -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center">
      <svg class="mx-auto h-12 w-12 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
      </svg>
      <h3 class="mt-4 text-lg font-medium text-gray-900">No Notifications</h3>
      <p class="mt-2 text-sm text-gray-500">You're all caught up! Check back later for new updates.</p>
    </div>
  }
</div>
